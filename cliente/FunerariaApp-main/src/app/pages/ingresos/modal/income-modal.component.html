<ion-header>
  <ion-toolbar color="primary">
    <ion-title>{{ isEditMode ? 'Modificar Ingreso' : 'Añadir Ingreso' }}</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="closeModal()">
        <ion-icon name="close"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <form (ngSubmit)="saveIncome()" class="ion-padding">
    <ion-grid>
      <ion-row>
        <ion-col size-md="6">

          <ion-item>
            <ion-label position="stacked">Concepto</ion-label>
            <ion-select [(ngModel)]="ingreso.ConceptoID" name="concepto" required interface="alert" searchbar="true" (ionChange)="updateCombinations()">
              <ion-select-option *ngFor="let item of concepto" [value]="item.ConceptoID">{{ item.Nombre }}</ion-select-option>
            </ion-select>
          </ion-item>

          <ion-item>
            <ion-label position="stacked">Fecha</ion-label>
            <ion-datetime display-format="MM/DD/YYYY" [(ngModel)]="ingreso.Fecha" name="fecha" required></ion-datetime>
          </ion-item>

          <ion-item>
            <ion-label position="stacked">Segmento</ion-label>
            <ion-select [(ngModel)]="ingreso.SegmentoID" name="segmento" required interface="alert" searchbar="true">
              <ion-select-option *ngFor="let item of segmento" [value]="item.SegmentoID">{{ item.Nombre }}</ion-select-option>
            </ion-select>
          </ion-item>

          <ion-item>
            <ion-label position="stacked">Categoría</ion-label>
            <ion-select [(ngModel)]="ingreso.CategoriaID" name="categoria" required interface="alert" searchbar="true">
              <ion-select-option *ngFor="let item of categoria" [value]="item.CategoriaID">{{ item.Nombre }}</ion-select-option>
            </ion-select>
          </ion-item>

          <ion-item>
            <ion-label position="stacked">Subcategoría</ion-label>
            <ion-select [(ngModel)]="ingreso.SubcategoriaID" name="subcategoria" required interface="alert" searchbar="true">
              <ion-select-option *ngFor="let item of subcategoria" [value]="item.SubcategoriaID">{{ item.Nombre }}</ion-select-option>
            </ion-select>
          </ion-item>

          <ion-item>
            <ion-label position="stacked">Proveedor</ion-label>
            <ion-input [(ngModel)]="ingreso.Proveedor" name="proveedor" required></ion-input>
          </ion-item>

          <ion-item>
            <ion-label position="stacked">Tipo de Ingreso</ion-label>
            <ion-select [(ngModel)]="ingreso.CajaChica" name="cajaChica" required interface="alert" searchbar="true">
              <ion-select-option [value]="true">Caja Chica</ion-select-option>
              <ion-select-option [value]="false">Cuenta Bancaria</ion-select-option>
            </ion-select>
          </ion-item>

          <ion-item>
            <ion-label position="stacked">Monto</ion-label>
            <ion-input [(ngModel)]="ingreso.Monto" name="monto" type="number" required></ion-input>
          </ion-item>

          <ion-item>
            <ion-label position="stacked">Fecha de Conciliación</ion-label>
            <ion-datetime display-format="MM/DD/YYYY" [(ngModel)]="ingreso.FechaConciliacion" name="fechaConciliacion" required></ion-datetime>
          </ion-item>
          
        </ion-col>

        <ion-col size-md="6">
          <ion-item>
            <ion-label position="stacked">Descripción</ion-label>
            <ion-input [(ngModel)]="ingreso.Descripcion" name="descripcion" required></ion-input>
          </ion-item>

          <ion-item>
            <ion-label position="stacked">Piezas</ion-label>
            <ion-input [(ngModel)]="ingreso.Piezas" name="piezas" type="number" required></ion-input>
          </ion-item>

          <ion-item>
            <ion-label position="stacked">Saldo</ion-label>
            <ion-input [(ngModel)]="ingreso.Saldo" name="saldo" type="number" required></ion-input>
          </ion-item>

          <ion-item>
            <ion-label position="stacked">Recibo</ion-label>
            <ion-input [(ngModel)]="ingreso.Comprobante" name="comprobante" required></ion-input>
          </ion-item>

          <ion-item>
            <ion-label position="stacked">Estado</ion-label>
            <ion-select [(ngModel)]="ingreso.EstatusComprobacionID" name="estatus" required interface="alert" searchbar="true">
              <ion-select-option *ngFor="let item of estatus" [value]="item.EstatusID">{{ item.Descripcion }}</ion-select-option>
            </ion-select>
          </ion-item>

          <ion-item>
            <ion-label position="stacked">Fecha de Autorización</ion-label>
            <ion-datetime display-format="MM/DD/YYYY" [(ngModel)]="ingreso.FechaAutorizacion" name="fechaAutorizacion" required></ion-datetime>
          </ion-item>

          <ion-item>
            <ion-label position="stacked">Usuario que Autorizó</ion-label>
            <ion-select [(ngModel)]="ingreso.UsuarioAutorizaID" name="usuarioAutorizaId" required interface="alert" searchbar="true">
              <ion-select-option *ngFor="let item of usuario" [value]="item.userId">{{ item.fullName }}</ion-select-option>
            </ion-select>
          </ion-item>

          <ion-item>
            <ion-label position="stacked">Recibido por</ion-label>
            <ion-select [(ngModel)]="ingreso.UsuarioRecibeID" name="usuarioRecibeId" required interface="alert" searchbar="true">
              <ion-select-option *ngFor="let item of usuario" [value]="item.userId">{{ item.fullName }}</ion-select-option>
            </ion-select>
          </ion-item>

          <ion-item>
            <ion-label position="stacked">Notas</ion-label>
            <ion-textarea rows="4" [(ngModel)]="ingreso.ObservacionesDifConciliacion" name="observacionesDifConciliacion" required></ion-textarea>
          </ion-item>
        </ion-col>
      </ion-row>
    </ion-grid>

    <ion-footer>
      <ion-button expand="full" type="submit">{{ isEditMode ? 'Modificar' : 'Añadir' }}</ion-button>
    </ion-footer>
  </form>
</ion-content>
