(()=>{"use strict";var e={948:(e,s,t)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.connect=async function(){return(0,o.createPool)({host:"localhost",user:"root",password:"",database:"funeraria_db",connectionLimit:10,timezone:"local"})};const o=t(498)},486:function(e,s,t){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(s,"__esModule",{value:!0}),s.App=void 0;const n=o(t(577)),r=o(t(252)),a=o(t(96)),l=o(t(3)),i=o(t(271)),u=o(t(612)),c="../../cliente/DirectoriCliente/";s.App=class{constructor(e){this.port=e,this.app=(0,r.default)(),this.settings(),this.middlewares(),this.routes()}settings(){this.app.set("port",this.port||process.env.PORT||3080),this.app.set("path",c)}allowCrossDomain(e,s,t){s.header("Access-Control-Allow-Origin","*"),s.header("Access-Control-Allow-Methods","GET,PUT,POST,DELETE"),s.header("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept, Cache-Control, Authorization, Content-Length"),"OPTIONS"==e.method?s.send(200):t()}middlewares(){this.app.use((0,a.default)("dev")),this.app.use((0,n.default)()),this.app.use(this.allowCrossDomain),this.app.use(r.default.json({limit:"1mb"})),this.app.use(r.default.urlencoded({extended:!0})),this.app.use(r.default.static(c))}routes(){this.app.use("/api/usuarios",i.default),this.app.use("/api/ingresos",u.default),this.app.get("*",(function(e,s){s.sendfile(l.default.join(c,"index.html"))}))}async listen(){this.app.listen(this.app.get("port")),console.log("server on port:",this.app.get("port"))}}},296:(e,s,t)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ObtenerConceptos=s.ObtenerIngresos=void 0;const o=t(948);s.ObtenerIngresos=async(e,s)=>{let t,n;try{t=await(0,o.connect)();let e="SELECT * FROM vistaingresos";n=(await t.query(e))[0]}catch(e){console.log("Error en Ingresos"),console.log(e),n=null}finally{return await(null==t?void 0:t.end()),s.json(n)}},s.ObtenerConceptos=async(e,s)=>{let t,n;try{t=await(0,o.connect)();let e="SELECT * FROM Conceptos";n=(await t.query(e))[0]}catch(e){console.log("Error en Conceptos"),console.log(e),n=null}finally{return await(null==t?void 0:t.end()),s.json(n)}}},918:(e,s,t)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.UpdateUser=s.PostUsers=s.ObtenerUsuarios=s.Login=void 0;const o=t(948);s.Login=async(e,s)=>{const{email:t,password:n}=e.body;let r,a;try{r=await(0,o.connect)();const e="SELECT * FROM usuarios WHERE email = ?",s=(await r.query(e,[t]))[0];if(s.length>0){const e=s[0];a=e.password===n?e:null}else a=null}catch(e){console.log("Error en Login"),console.log(e),a=null}finally{return await(null==r?void 0:r.end()),a?s.json({success:!0,user:a}):s.status(401).json({success:!1,message:"Credenciales incorrectas"})}},s.ObtenerUsuarios=async(e,s)=>{let t,n;try{t=await(0,o.connect)();let e="SELECT * FROM usuarios";n=(await t.query(e))[0]}catch(e){console.log("Error en Usuarios"),console.log(e),n=null}finally{return await(null==t?void 0:t.end()),s.json(n)}},s.PostUsers=async(e,s)=>{let t,n;const{fullName:r,phone:a,email:l,isAdmin:i}=e.body;try{t=await(0,o.connect)();let e="SELECT COUNT(*) AS count FROM usuarios WHERE email = ?";const[s]=await t.query(e,[l]);if(s.length>0&&s[0].count>0)n={message:"Email already exists. User not created."};else{e="INSERT INTO usuarios (fullName, phone, email, isAdmin, password) VALUES (?, ?, ?, ?, ?)";const s=[r,a,l,i,123456];await t.query(e,s),n={message:"User created successfully"}}}catch(e){console.log("Error en Usuarios"),console.log(e),n={message:"Error creating user"}}finally{return await(null==t?void 0:t.end()),s.json(n)}},s.UpdateUser=async(e,s)=>{let t,n;const{userId:r,fullName:a,phone:l,email:i,isAdmin:u}=e.body;try{t=await(0,o.connect)();let e="UPDATE usuarios SET fullName = ?, phone = ?, email = ?, isAdmin = ? WHERE userId = ?";const s=[a,l,i,u,r];await t.query(e,s),n={message:"User updated successfully"}}catch(e){console.log("Error en Usuarios"),console.log(e),n={message:"Error updating user"}}finally{return await(null==t?void 0:t.end()),s.json(n)}}},612:(e,s,t)=>{Object.defineProperty(s,"__esModule",{value:!0});const o=t(252),n=t(296),r=(0,o.Router)();r.get("/GetIngresos",n.ObtenerIngresos),r.get("/GetConceptos",n.ObtenerConceptos),s.default=r},271:(e,s,t)=>{Object.defineProperty(s,"__esModule",{value:!0});const o=t(252),n=t(918),r=(0,o.Router)();r.get("/GetUsuarios",n.ObtenerUsuarios),r.post("/PostUsers",n.PostUsers),r.put("/UpdateUser",n.UpdateUser),r.post("/login",n.Login),s.default=r},577:e=>{e.exports=require("cors")},252:e=>{e.exports=require("express")},96:e=>{e.exports=require("morgan")},498:e=>{e.exports=require("mysql2/promise")},3:e=>{e.exports=require("path")}},s={};function t(o){var n=s[o];if(void 0!==n)return n.exports;var r=s[o]={exports:{}};return e[o].call(r.exports,r,r.exports,t),r.exports}(()=>{const e=t(486);!async function(){const s=new e.App(3080);await s.listen()}()})()})();